<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        html, body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="viewport"></div>
<script type="text/javascript" src="/example/lib/three.js"></script>
<script type="text/javascript" src="/example/lib/ColladaLoader.js"></script>
<script type="text/javascript">
    var scene;
    var camera;
    var renderer;
    var plane;
    var raycaster;

    window.onload = function() {
        initScene();
    };

    var initScene = function() {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(100, 100, 0);
        camera.lookAt(new THREE.Vector3(0, 10, 0));
        var axes = new THREE.AxisHelper(20);
        scene.add(axes);

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document
                .getElementById('viewport')
                .appendChild(renderer.domElement);

        reigsterEventListener();

        createPlane();
        createLight();
        render();
    };

    var render = function() {
        renderer.render(scene, camera);

        requestAnimationFrame(render);
    };

    var createPlane = function() {
        var planeGeometry = new THREE.PlaneGeometry(100, 100, 100, 100);
        var planeMaterial = new THREE.MeshPhongMaterial({
            color: 0xEEEEEE,
            vertexColors: THREE.FaceColors,
            wireframe: true
        });

        plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.position.set(0, -1, 0);
        plane.rotation.x = -0.5 * Math.PI;
        console.log(plane);
        scene.add(plane);
    };

    var createLight = function() {
        var ambientLight = new THREE.AmbientLight(0xE0E0E0);
        scene.add(ambientLight);

        var spotlight = new THREE.SpotLight(0xFFFFFF);
        spotlight.position.set(50, 60, 0);
        spotlight.lookAt(plane);

        var spotlightHelper = new THREE.SpotLightHelper(spotlight);

        scene.add(spotlightHelper);
    };

    var reigsterEventListener = function() {

        var raycaster = new THREE.Raycaster();
        window.addEventListener( 'click', function(event) {
            var mouse = {};
            mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
            mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

            plane.updateMatrix();

            // calculate mouse position in normalized device coordinates
            // (-1 to +1) for both components
            raycaster.setFromCamera( mouse, camera );

            // See if the ray from the camera into the world hits one of our meshes
            var intersects = raycaster.intersectObject( plane, false );
            // Toggle rotation bool for meshes that we clicked

            var match = intersects[0];

            if (match) {
                var geometry = match.object.geometry;
                var face = geometry.faces[match.faceIndex];

                face.color.setHex( Math.random() * 0xffffff );
                geometry.colorsNeedUpdate = true;
            }
        });
    }
</script>
</body>
</html>